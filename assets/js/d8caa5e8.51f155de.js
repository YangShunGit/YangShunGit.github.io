"use strict";(self.webpackChunkys_blog=self.webpackChunkys_blog||[]).push([[5938],{1001:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"\u6e90\u7801\u5206\u6790/React/React\u6574\u4f53\u67b6\u6784","title":"React\u6574\u4f53\u67b6\u6784","description":"\u4ee5\u4e0b\u662f React \u6574\u4f53\u67b6\u6784\u7684\u6838\u5fc3\u539f\u7406\u6df1\u5ea6\u89e3\u6790\uff0c\u7ed3\u5408\u6e90\u7801\u4e0e\u8bbe\u8ba1\u601d\u60f3\uff1a","source":"@site/frontend/\u6e90\u7801\u5206\u6790/React/React\u6574\u4f53\u67b6\u6784.md","sourceDirName":"\u6e90\u7801\u5206\u6790/React","slug":"/\u6e90\u7801\u5206\u6790/React/React\u6574\u4f53\u67b6\u6784","permalink":"/frontend/\u6e90\u7801\u5206\u6790/React/React\u6574\u4f53\u67b6\u6784","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/frontend/\u6e90\u7801\u5206\u6790/React/React\u6574\u4f53\u67b6\u6784.md","tags":[],"version":"current","frontMatter":{},"sidebar":"frontend","previous":{"title":"Hooks\u5b9e\u73b0\u539f\u7406","permalink":"/frontend/\u6e90\u7801\u5206\u6790/React/Hooks\u5b9e\u73b0\u539f\u7406"},"next":{"title":"Reconciliation\u8c03\u548c","permalink":"/frontend/\u6e90\u7801\u5206\u6790/React/Reconciliation\u8c03\u548c"}}');var s=r(4848),i=r(8453);const l={},o=void 0,c={},d=[{value:"<strong>\u4e00\u3001\u67b6\u6784\u5206\u5c42\u8bbe\u8ba1</strong>",id:"\u4e00\u67b6\u6784\u5206\u5c42\u8bbe\u8ba1",level:3},{value:"1. <strong>\u534f\u8c03\u5c42 (Reconciler)</strong>",id:"1-\u534f\u8c03\u5c42-reconciler",level:4},{value:"2. <strong>\u8c03\u5ea6\u5c42 (Scheduler)</strong>",id:"2-\u8c03\u5ea6\u5c42-scheduler",level:4},{value:"3. <strong>\u6e32\u67d3\u5c42 (Renderer)</strong>",id:"3-\u6e32\u67d3\u5c42-renderer",level:4},{value:"<strong>\u4e8c\u3001Fiber \u67b6\u6784\u6838\u5fc3</strong>",id:"\u4e8cfiber-\u67b6\u6784\u6838\u5fc3",level:3},{value:"<strong>\u53cc\u7f13\u5b58\u6811\u673a\u5236</strong>",id:"\u53cc\u7f13\u5b58\u6811\u673a\u5236",level:4},{value:"<strong>\u4e09\u3001\u6e32\u67d3\u6d41\u7a0b\u8be6\u89e3</strong>",id:"\u4e09\u6e32\u67d3\u6d41\u7a0b\u8be6\u89e3",level:3},{value:"1. <strong>\u66f4\u65b0\u89e6\u53d1\u9636\u6bb5</strong>",id:"1-\u66f4\u65b0\u89e6\u53d1\u9636\u6bb5",level:4},{value:"2. <strong>\u8c03\u5ea6\u9636\u6bb5</strong>",id:"2-\u8c03\u5ea6\u9636\u6bb5",level:4},{value:"3. <strong>\u534f\u8c03\u9636\u6bb5\uff08Reconciliation\uff09</strong>",id:"3-\u534f\u8c03\u9636\u6bb5reconciliation",level:4},{value:"4. <strong>\u63d0\u4ea4\u9636\u6bb5\uff08Commit\uff09</strong>",id:"4-\u63d0\u4ea4\u9636\u6bb5commit",level:4},{value:"<strong>\u56db\u3001\u72b6\u6001\u7ba1\u7406\u673a\u5236</strong>",id:"\u56db\u72b6\u6001\u7ba1\u7406\u673a\u5236",level:3},{value:"1. <strong>Fiber \u8282\u70b9\u7684\u72b6\u6001\u5b58\u50a8</strong>",id:"1-fiber-\u8282\u70b9\u7684\u72b6\u6001\u5b58\u50a8",level:4},{value:"2. <strong>\u72b6\u6001\u66f4\u65b0\u8def\u5f84</strong>",id:"2-\u72b6\u6001\u66f4\u65b0\u8def\u5f84",level:4},{value:"<strong>\u4e94\u3001\u4e8b\u4ef6\u7cfb\u7edf</strong>",id:"\u4e94\u4e8b\u4ef6\u7cfb\u7edf",level:3},{value:"<strong>\u516d\u3001\u6027\u80fd\u4f18\u5316\u673a\u5236</strong>",id:"\u516d\u6027\u80fd\u4f18\u5316\u673a\u5236",level:3},{value:"1. <strong>Memoization \u6280\u672f</strong>",id:"1-memoization-\u6280\u672f",level:4},{value:"2. <strong>\u61d2\u52a0\u8f7d\u4e0e Suspense</strong>",id:"2-\u61d2\u52a0\u8f7d\u4e0e-suspense",level:4},{value:"<strong>\u4e03\u3001\u672a\u6765\u53d1\u5c55\u65b9\u5411</strong>",id:"\u4e03\u672a\u6765\u53d1\u5c55\u65b9\u5411",level:3}];function a(n){const e={code:"code",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.p,{children:"\u4ee5\u4e0b\u662f React \u6574\u4f53\u67b6\u6784\u7684\u6838\u5fc3\u539f\u7406\u6df1\u5ea6\u89e3\u6790\uff0c\u7ed3\u5408\u6e90\u7801\u4e0e\u8bbe\u8ba1\u601d\u60f3\uff1a"}),"\n",(0,s.jsx)(e.h3,{id:"\u4e00\u67b6\u6784\u5206\u5c42\u8bbe\u8ba1",children:(0,s.jsx)(e.strong,{children:"\u4e00\u3001\u67b6\u6784\u5206\u5c42\u8bbe\u8ba1"})}),"\n",(0,s.jsx)(e.p,{children:"React \u91c7\u7528\u4e09\u5c42\u67b6\u6784\u8bbe\u8ba1\uff0c\u6bcf\u5c42\u804c\u8d23\u6e05\u6670\u5206\u79bb\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     \u6e32\u67d3\u5c42 (Renderer) \u2502\u25c4\u2500\u2500\u2500\u2524     \u8c03\u5ea6\u5c42 (Scheduler) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u25b2                        \u25b2\n              \u2502                        \u2502\n              \u25bc                        \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                \u2502\n\u2502   \u534f\u8c03\u5c42 (Reconciler) \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsxs)(e.h4,{id:"1-\u534f\u8c03\u5c42-reconciler",children:["1. ",(0,s.jsx)(e.strong,{children:"\u534f\u8c03\u5c42 (Reconciler)"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u6838\u5fc3\u804c\u8d23"}),"\uff1a\u5bf9\u6bd4\u65b0\u65e7 Virtual DOM\uff0c\u751f\u6210\u526f\u4f5c\u7528\u5217\u8868"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u5173\u952e\u6280\u672f"}),"\uff1aFiber \u67b6\u6784\u3001\u53cc\u7f13\u5b58\u6811\u3001Diff \u7b97\u6cd5"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u6e90\u7801\u4f4d\u7f6e"}),"\uff1a",(0,s.jsx)(e.code,{children:"react-reconciler"})," \u5305"]}),"\n"]}),"\n",(0,s.jsxs)(e.h4,{id:"2-\u8c03\u5ea6\u5c42-scheduler",children:["2. ",(0,s.jsx)(e.strong,{children:"\u8c03\u5ea6\u5c42 (Scheduler)"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u6838\u5fc3\u804c\u8d23"}),"\uff1a\u63a7\u5236\u4efb\u52a1\u4f18\u5148\u7ea7\u4e0e\u6267\u884c\u65f6\u673a"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u5173\u952e\u6280\u672f"}),"\uff1aLane \u6a21\u578b\u3001\u65f6\u95f4\u5207\u7247\u3001\u4efb\u52a1\u961f\u5217"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u6e90\u7801\u4f4d\u7f6e"}),"\uff1a",(0,s.jsx)(e.code,{children:"scheduler"})," \u5305"]}),"\n"]}),"\n",(0,s.jsxs)(e.h4,{id:"3-\u6e32\u67d3\u5c42-renderer",children:["3. ",(0,s.jsx)(e.strong,{children:"\u6e32\u67d3\u5c42 (Renderer)"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u6838\u5fc3\u804c\u8d23"}),"\uff1a\u5c06\u534f\u8c03\u7ed3\u679c\u6e32\u67d3\u5230\u76ee\u6807\u5e73\u53f0"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u5e38\u89c1\u5b9e\u73b0"}),"\uff1aReactDOM\u3001React Native\u3001React Test Renderer"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u6e90\u7801\u4f4d\u7f6e"}),"\uff1a",(0,s.jsx)(e.code,{children:"react-dom"}),"\u3001",(0,s.jsx)(e.code,{children:"react-native"})," \u7b49\u5305"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"\u4e8cfiber-\u67b6\u6784\u6838\u5fc3",children:(0,s.jsx)(e.strong,{children:"\u4e8c\u3001Fiber \u67b6\u6784\u6838\u5fc3"})}),"\n",(0,s.jsx)(e.p,{children:"Fiber \u662f React 16+ \u7684\u6838\u5fc3\u6570\u636e\u7ed3\u6784\uff0c\u5b9e\u73b0\u4e86\u53ef\u4e2d\u65ad\u6e32\u67d3\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"// \u7b80\u5316\u7684 Fiber \u8282\u70b9\u7ed3\u6784\nconst fiber = {\n  type: 'div',            // \u7ec4\u4ef6\u7c7b\u578b\n  stateNode: null,        // \u5bf9\u5e94\u7684 DOM \u8282\u70b9\u6216\u7ec4\u4ef6\u5b9e\u4f8b\n  props: {},              // \u4f20\u5165\u7684\u5c5e\u6027\n  pendingProps: {},       // \u5f85\u5904\u7406\u7684\u65b0\u5c5e\u6027\n  memoizedState: null,    // \u72b6\u6001\u503c\n  return: null,           // \u7236 Fiber \u8282\u70b9\n  child: null,            // \u7b2c\u4e00\u4e2a\u5b50 Fiber \u8282\u70b9\n  sibling: null,          // \u4e0b\u4e00\u4e2a\u5144\u5f1f Fiber \u8282\u70b9\n  alternate: null,        // \u53cc\u7f13\u5b58\u6811\u4e2d\u7684\u53e6\u4e00\u4e2a Fiber\n  effectTag: 0,           // \u526f\u4f5c\u7528\u6807\u8bb0 (\u63d2\u5165/\u66f4\u65b0/\u5220\u9664)\n  lane: 0,                // \u4f18\u5148\u7ea7\u6807\u8bb0\n  // ...\n};\n"})}),"\n",(0,s.jsx)(e.h4,{id:"\u53cc\u7f13\u5b58\u6811\u673a\u5236",children:(0,s.jsx)(e.strong,{children:"\u53cc\u7f13\u5b58\u6811\u673a\u5236"})}),"\n",(0,s.jsx)(e.p,{children:"React \u4f7f\u7528\u53cc\u7f13\u5b58\u6280\u672f\u63d0\u5347\u6e32\u67d3\u6548\u7387\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"current \u6811"}),"\uff1a\u5f53\u524d\u5c4f\u5e55\u4e0a\u663e\u793a\u7684\u5185\u5bb9"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"workInProgress \u6811"}),"\uff1a\u6b63\u5728\u6784\u5efa\u7684\u65b0\u6811"]}),"\n",(0,s.jsxs)(e.li,{children:["\u901a\u8fc7 ",(0,s.jsx)(e.code,{children:"alternate"})," \u5c5e\u6027\u8fde\u63a5\u4e24\u68f5\u6811\u7684\u5bf9\u5e94\u8282\u70b9"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"\u4e09\u6e32\u67d3\u6d41\u7a0b\u8be6\u89e3",children:(0,s.jsx)(e.strong,{children:"\u4e09\u3001\u6e32\u67d3\u6d41\u7a0b\u8be6\u89e3"})}),"\n",(0,s.jsxs)(e.h4,{id:"1-\u66f4\u65b0\u89e6\u53d1\u9636\u6bb5",children:["1. ",(0,s.jsx)(e.strong,{children:"\u66f4\u65b0\u89e6\u53d1\u9636\u6bb5"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"// \u5f53\u8c03\u7528 setState \u6216 useState \u7684\u66f4\u65b0\u51fd\u6570\u65f6\nfunction dispatchSetState(fiber, action) {\n  // \u521b\u5efa\u66f4\u65b0\u5bf9\u8c61\n  const update = createUpdate();\n  // \u5c06\u66f4\u65b0\u52a0\u5165\u961f\u5217\n  enqueueUpdate(fiber, update);\n  // \u8bf7\u6c42\u8c03\u5ea6\n  scheduleUpdateOnFiber(fiber);\n}\n"})}),"\n",(0,s.jsxs)(e.h4,{id:"2-\u8c03\u5ea6\u9636\u6bb5",children:["2. ",(0,s.jsx)(e.strong,{children:"\u8c03\u5ea6\u9636\u6bb5"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"// scheduler \u5305\u6838\u5fc3\u903b\u8f91\nfunction scheduleCallback(priorityLevel, callback) {\n  // \u521b\u5efa\u4efb\u52a1\n  const newTask = {\n    id: taskIdCounter++,\n    callback,\n    priorityLevel,\n    expirationTime: calculateExpirationTime(priorityLevel)\n  };\n  \n  // \u5c06\u4efb\u52a1\u52a0\u5165\u8c03\u5ea6\u961f\u5217\n  pushTask(newTask);\n  \n  // \u8bf7\u6c42\u6d4f\u89c8\u5668\u7a7a\u95f2\u65f6\u6bb5\u6267\u884c\u4efb\u52a1\n  requestHostCallback(flushWork);\n}\n"})}),"\n",(0,s.jsxs)(e.h4,{id:"3-\u534f\u8c03\u9636\u6bb5reconciliation",children:["3. ",(0,s.jsx)(e.strong,{children:"\u534f\u8c03\u9636\u6bb5\uff08Reconciliation\uff09"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"// react-reconciler \u6838\u5fc3\u5faa\u73af\nfunction workLoopConcurrent() {\n  while (workInProgress !== null) {\n    if (shouldYield()) {\n      // \u65f6\u95f4\u7247\u7528\u5c3d\uff0c\u6682\u505c\u5de5\u4f5c\n      return;\n    }\n    performUnitOfWork(workInProgress);\n  }\n}\n\nfunction performUnitOfWork(fiber) {\n  // 1. \u6267\u884c\u7ec4\u4ef6 render \u51fd\u6570\n  const nextChildren = beginWork(fiber);\n  \n  // 2. \u5904\u7406\u5b50\u8282\u70b9\n  if (nextChildren) {\n    workInProgress.child = reconcileChildren(fiber, nextChildren);\n  } else {\n    // 3. \u5b8c\u6210\u5f53\u524d\u8282\u70b9\uff0c\u5904\u7406\u526f\u4f5c\u7528\n    completeUnitOfWork(fiber);\n  }\n}\n"})}),"\n",(0,s.jsxs)(e.h4,{id:"4-\u63d0\u4ea4\u9636\u6bb5commit",children:["4. ",(0,s.jsx)(e.strong,{children:"\u63d0\u4ea4\u9636\u6bb5\uff08Commit\uff09"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"function commitRoot(root) {\n  const finishedWork = root.current.alternate;\n  \n  // 1. \u6267\u884c DOM \u64cd\u4f5c\u524d\u7684\u526f\u4f5c\u7528 (\u5982 beforeMutation)\n  commitBeforeMutationEffects();\n  \n  // 2. \u6267\u884c DOM \u64cd\u4f5c (\u63d2\u5165/\u66f4\u65b0/\u5220\u9664)\n  commitMutationEffects();\n  \n  // 3. \u6267\u884c DOM \u64cd\u4f5c\u540e\u7684\u526f\u4f5c\u7528 (\u5982 layout)\n  commitLayoutEffects();\n  \n  // 4. \u66f4\u65b0\u5f53\u524d\u6811\n  root.current = finishedWork;\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u56db\u72b6\u6001\u7ba1\u7406\u673a\u5236",children:(0,s.jsx)(e.strong,{children:"\u56db\u3001\u72b6\u6001\u7ba1\u7406\u673a\u5236"})}),"\n",(0,s.jsxs)(e.h4,{id:"1-fiber-\u8282\u70b9\u7684\u72b6\u6001\u5b58\u50a8",children:["1. ",(0,s.jsx)(e.strong,{children:"Fiber \u8282\u70b9\u7684\u72b6\u6001\u5b58\u50a8"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"// \u7b80\u5316\u7684 useState \u5b9e\u73b0\nfunction useState(initialState) {\n  const fiber = getCurrentFiber();\n  let hook;\n  \n  // \u9996\u6b21\u6e32\u67d3\u521b\u5efa hook\n  if (fiber.memoizedState === null) {\n    hook = {\n      memoizedState: initialState,\n      queue: { pending: null },\n      next: null\n    };\n    fiber.memoizedState = hook;\n  } else {\n    // \u540e\u7eed\u6e32\u67d3\u83b7\u53d6\u5df2\u6709 hook\n    hook = fiber.memoizedState;\n  }\n  \n  // \u5904\u7406\u66f4\u65b0\u961f\u5217\n  const queue = hook.queue;\n  if (queue.pending !== null) {\n    const firstUpdate = queue.pending.next;\n    let update = firstUpdate;\n    \n    do {\n      const action = update.action;\n      hook.memoizedState = action(hook.memoizedState);\n      update = update.next;\n    } while (update !== null && update !== firstUpdate);\n    \n    queue.pending = null;\n  }\n  \n  // \u8fd4\u56de\u5f53\u524d\u72b6\u6001\u548c\u66f4\u65b0\u51fd\u6570\n  const setState = (action) => {\n    const update = createUpdate();\n    update.action = action;\n    enqueueUpdate(queue, update);\n    scheduleUpdateOnFiber(fiber);\n  };\n  \n  return [hook.memoizedState, setState];\n}\n"})}),"\n",(0,s.jsxs)(e.h4,{id:"2-\u72b6\u6001\u66f4\u65b0\u8def\u5f84",children:["2. ",(0,s.jsx)(e.strong,{children:"\u72b6\u6001\u66f4\u65b0\u8def\u5f84"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u7528\u6237\u4ea4\u4e92/\u5f02\u6b65\u64cd\u4f5c \u2192 setState/useState \u2192 \u521b\u5efa\u66f4\u65b0\u5bf9\u8c61 \u2192 \n\u52a0\u5165\u66f4\u65b0\u961f\u5217 \u2192 \u8bf7\u6c42\u8c03\u5ea6 \u2192 \u534f\u8c03\u9636\u6bb5\u5904\u7406\u66f4\u65b0 \u2192 \n\u63d0\u4ea4\u9636\u6bb5\u5e94\u7528\u53d8\u66f4 \u2192 \u89e6\u53d1\u91cd\u65b0\u6e32\u67d3\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u4e94\u4e8b\u4ef6\u7cfb\u7edf",children:(0,s.jsx)(e.strong,{children:"\u4e94\u3001\u4e8b\u4ef6\u7cfb\u7edf"})}),"\n",(0,s.jsx)(e.p,{children:"React \u5b9e\u73b0\u4e86\u5408\u6210\u4e8b\u4ef6\uff08SyntheticEvent\uff09\u7cfb\u7edf\uff1a"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u4e8b\u4ef6\u59d4\u6258"}),"\uff1a\u6240\u6709\u4e8b\u4ef6\u7ed1\u5b9a\u5230\u6839 DOM \u8282\u70b9"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u4e8b\u4ef6\u5192\u6ce1"}),"\uff1a\u6a21\u62df\u539f\u751f\u4e8b\u4ef6\u4f20\u64ad\u673a\u5236"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u8de8\u5e73\u53f0\u517c\u5bb9"}),"\uff1a\u7edf\u4e00\u5904\u7406\u4e0d\u540c\u6d4f\u89c8\u5668\u7684\u5dee\u5f02"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"// \u7b80\u5316\u7684\u4e8b\u4ef6\u7ed1\u5b9a\u903b\u8f91\nfunction listenToEvent(eventType, target) {\n  // \u68c0\u67e5\u662f\u5426\u5df2\u7ed1\u5b9a\u8be5\u4e8b\u4ef6\u7c7b\u578b\n  if (!listeningMarker.has(eventType)) {\n    // \u521b\u5efa\u4e8b\u4ef6\u63d2\u4ef6\n    const pluginModule = getEventPluginModuleForEvent(eventType);\n    \n    // \u5728\u6839\u8282\u70b9\u4e0a\u7ed1\u5b9a\u539f\u751f\u4e8b\u4ef6\n    target.addEventListener(\n      eventType,\n      createEventListenerWrapperWithPriority(eventType, pluginModule)\n    );\n    \n    listeningMarker.add(eventType);\n  }\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u516d\u6027\u80fd\u4f18\u5316\u673a\u5236",children:(0,s.jsx)(e.strong,{children:"\u516d\u3001\u6027\u80fd\u4f18\u5316\u673a\u5236"})}),"\n",(0,s.jsxs)(e.h4,{id:"1-memoization-\u6280\u672f",children:["1. ",(0,s.jsx)(e.strong,{children:"Memoization \u6280\u672f"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"// React.memo \u6e90\u7801\u7b80\u5316\nfunction memo(Component, compare) {\n  const type = {\n    $$typeof: REACT_MEMO_TYPE,\n    render: Component,\n    compare: compare === undefined ? shallowEqual : compare,\n  };\n  return type;\n}\n\n// \u6d45\u6bd4\u8f83\u5b9e\u73b0\nfunction shallowEqual(objA, objB) {\n  if (Object.is(objA, objB)) {\n    return true;\n  }\n\n  if (\n    typeof objA !== 'object' ||\n    objA === null ||\n    typeof objB !== 'object' ||\n    objB === null\n  ) {\n    return false;\n  }\n\n  const keysA = Object.keys(objA);\n  const keysB = Object.keys(objB);\n\n  if (keysA.length !== keysB.length) {\n    return false;\n  }\n\n  for (let i = 0; i < keysA.length; i++) {\n    if (\n      !Object.prototype.hasOwnProperty.call(objB, keysA[i]) ||\n      !Object.is(objA[keysA[i]], objB[keysA[i]])\n    ) {\n      return false;\n    }\n  }\n\n  return true;\n}\n"})}),"\n",(0,s.jsxs)(e.h4,{id:"2-\u61d2\u52a0\u8f7d\u4e0e-suspense",children:["2. ",(0,s.jsx)(e.strong,{children:"\u61d2\u52a0\u8f7d\u4e0e Suspense"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"// React.lazy \u6e90\u7801\u7b80\u5316\nfunction lazy(ctor) {\n  let lazyType = {\n    $$typeof: REACT_LAZY_TYPE,\n    _ctor: ctor,\n    _status: -1, // -1 \u672a\u52a0\u8f7d, 0 \u52a0\u8f7d\u4e2d, 1 \u5df2\u52a0\u8f7d\n    _result: null,\n  };\n\n  return lazyType;\n}\n\n// Suspense \u8fb9\u754c\u5904\u7406\nfunction SuspenseComponent(props) {\n  const { fallback, children } = props;\n  \n  try {\n    // \u5c1d\u8bd5\u6e32\u67d3\u5b50\u7ec4\u4ef6\n    return children;\n  } catch (error) {\n    if (isThenable(error)) {\n      // \u9047\u5230 Promise\uff0c\u663e\u793a fallback\n      return fallback;\n    }\n    throw error;\n  }\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u4e03\u672a\u6765\u53d1\u5c55\u65b9\u5411",children:(0,s.jsx)(e.strong,{children:"\u4e03\u3001\u672a\u6765\u53d1\u5c55\u65b9\u5411"})}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u5e76\u53d1\u6a21\u5f0f\uff08Concurrent Mode\uff09"}),"\uff1a\u66f4\u7cbe\u7ec6\u7684\u4f18\u5148\u7ea7\u63a7\u5236"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u81ea\u52a8\u6279\u5904\u7406\uff08Automatic Batching\uff09"}),"\uff1a\u4f18\u5316\u72b6\u6001\u66f4\u65b0\u6027\u80fd"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u9009\u62e9\u6027\u6c34\u5408\uff08Selective Hydration\uff09"}),"\uff1a\u670d\u52a1\u7aef\u6e32\u67d3\u7684\u6027\u80fd\u63d0\u5347"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"React Server Components"}),"\uff1a\u670d\u52a1\u7aef\u6e32\u67d3\u7684\u65b0\u8303\u5f0f"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u7406\u89e3 React \u6574\u4f53\u67b6\u6784\u6709\u52a9\u4e8e\u7f16\u5199\u9ad8\u6027\u80fd\u3001\u53ef\u7ef4\u62a4\u7684\u5e94\u7528\uff0c\u7279\u522b\u662f\u5728\u5904\u7406\u590d\u6742\u72b6\u6001\u7ba1\u7406\u548c\u6027\u80fd\u4f18\u5316\u65f6\u3002\u901a\u8fc7\u638c\u63e1\u67b6\u6784\u539f\u7406\uff0c\u53ef\u4ee5\u66f4\u6df1\u5165\u5730\u7406\u89e3 React \u7684\u8bbe\u8ba1\u54f2\u5b66\uff0c\u907f\u514d\u5e38\u89c1\u7684\u6027\u80fd\u9677\u9631\u3002"})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(a,{...n})}):a(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>o});var t=r(6540);const s={},i=t.createContext(s);function l(n){const e=t.useContext(i);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),t.createElement(i.Provider,{value:e},n.children)}}}]);