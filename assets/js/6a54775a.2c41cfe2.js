"use strict";(self.webpackChunkys_blog=self.webpackChunkys_blog||[]).push([[1999],{2363:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"\u8ba1\u7b97\u673a\u57fa\u7840/http/springboot2\u5b9e\u73b0see\u63a5\u53e3","title":"springboot2\u5b9e\u73b0see\u63a5\u53e3","description":"\u5728Spring Boot 2\u4e2d\u5b9e\u73b0Server-Sent Events\uff08SEE\uff09\u63a5\u53e3\u975e\u5e38\u4fbf\u6377\uff0c\u4ee5\u4e0b\u662f\u5b8c\u6574\u7684\u5b9e\u73b0\u65b9\u6848\uff1a","source":"@site/frontend/\u8ba1\u7b97\u673a\u57fa\u7840/http/springboot2\u5b9e\u73b0see\u63a5\u53e3.md","sourceDirName":"\u8ba1\u7b97\u673a\u57fa\u7840/http","slug":"/\u8ba1\u7b97\u673a\u57fa\u7840/http/springboot2\u5b9e\u73b0see\u63a5\u53e3","permalink":"/frontend/\u8ba1\u7b97\u673a\u57fa\u7840/http/springboot2\u5b9e\u73b0see\u63a5\u53e3","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/frontend/\u8ba1\u7b97\u673a\u57fa\u7840/http/springboot2\u5b9e\u73b0see\u63a5\u53e3.md","tags":[],"version":"current","frontMatter":{},"sidebar":"frontend","previous":{"title":"cookie","permalink":"/frontend/\u8ba1\u7b97\u673a\u57fa\u7840/http/cookie"},"next":{"title":"websocket\u548csee\u533a\u522b","permalink":"/frontend/\u8ba1\u7b97\u673a\u57fa\u7840/http/websocket\u548csee\u533a\u522b"}}');var i=r(4848),s=r(8453);const o={},l=void 0,c={},d=[{value:"<strong>1. \u6dfb\u52a0\u4f9d\u8d56</strong>",id:"1-\u6dfb\u52a0\u4f9d\u8d56",level:3},{value:"<strong>2. \u521b\u5efaSEE\u63a7\u5236\u5668</strong>",id:"2-\u521b\u5efasee\u63a7\u5236\u5668",level:3},{value:"<strong>3. \u914d\u7f6e\u5f02\u6b65\u652f\u6301</strong>",id:"3-\u914d\u7f6e\u5f02\u6b65\u652f\u6301",level:3},{value:"<strong>4. \u5ba2\u6237\u7aef\u4f7f\u7528\u793a\u4f8b</strong>",id:"4-\u5ba2\u6237\u7aef\u4f7f\u7528\u793a\u4f8b",level:3},{value:"<strong>5. \u4e3b\u52a8\u63a8\u9001\u6d88\u606f\u793a\u4f8b</strong>",id:"5-\u4e3b\u52a8\u63a8\u9001\u6d88\u606f\u793a\u4f8b",level:3},{value:"<strong>6. \u5173\u952e\u914d\u7f6e\u8bf4\u660e</strong>",id:"6-\u5173\u952e\u914d\u7f6e\u8bf4\u660e",level:3},{value:"<strong>7. \u751f\u4ea7\u73af\u5883\u4f18\u5316\u5efa\u8bae</strong>",id:"7-\u751f\u4ea7\u73af\u5883\u4f18\u5316\u5efa\u8bae",level:3},{value:"<strong>8. \u5b8c\u6574\u793a\u4f8b\u4ee3\u7801</strong>",id:"8-\u5b8c\u6574\u793a\u4f8b\u4ee3\u7801",level:3},{value:"<strong>9. \u5ba2\u6237\u7aef\u9ad8\u7ea7\u7528\u6cd5</strong>",id:"9-\u5ba2\u6237\u7aef\u9ad8\u7ea7\u7528\u6cd5",level:3},{value:"<strong>10. \u5e38\u89c1\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848</strong>",id:"10-\u5e38\u89c1\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848",level:3}];function a(e){const n={code:"code",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"\u5728Spring Boot 2\u4e2d\u5b9e\u73b0Server-Sent Events\uff08SEE\uff09\u63a5\u53e3\u975e\u5e38\u4fbf\u6377\uff0c\u4ee5\u4e0b\u662f\u5b8c\u6574\u7684\u5b9e\u73b0\u65b9\u6848\uff1a"}),"\n",(0,i.jsx)(n.h3,{id:"1-\u6dfb\u52a0\u4f9d\u8d56",children:(0,i.jsx)(n.strong,{children:"1. \u6dfb\u52a0\u4f9d\u8d56"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5728",(0,i.jsx)(n.code,{children:"pom.xml"}),"\u4e2d\u6dfb\u52a0Spring Web\u4f9d\u8d56\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-web</artifactId>\n</dependency>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-\u521b\u5efasee\u63a7\u5236\u5668",children:(0,i.jsx)(n.strong,{children:"2. \u521b\u5efaSEE\u63a7\u5236\u5668"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528",(0,i.jsx)(n.code,{children:"SseEmitter"}),"\u7c7b\u5904\u7406\u957f\u8fde\u63a5\u548c\u4e8b\u4ef6\u63a8\u9001\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'import org.springframework.http.MediaType;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RestController;\nimport org.springframework.web.servlet.mvc.method.annotation.SseEmitter;\n\nimport java.io.IOException;\nimport java.util.concurrent.ConcurrentHashMap;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.ScheduledExecutorService;\nimport java.util.concurrent.TimeUnit;\n\n@RestController\npublic class SseController {\n\n    // \u5b58\u50a8\u6240\u6709\u5ba2\u6237\u7aef\u7684SseEmitter\n    private final ConcurrentHashMap<String, SseEmitter> emitters = new ConcurrentHashMap<>();\n    private final ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);\n\n    // \u5ba2\u6237\u7aef\u8ba2\u9605\u63a5\u53e3\n    @GetMapping(path = "/sse", produces = MediaType.TEXT_EVENT_STREAM_VALUE)\n    public SseEmitter subscribe() {\n        // \u521b\u5efaSseEmitter\uff0c\u8d85\u65f6\u65f6\u95f4\u8bbe\u4e3a30\u5206\u949f\n        SseEmitter emitter = new SseEmitter(30 * 60 * 1000L);\n        \n        // \u751f\u6210\u552f\u4e00\u5ba2\u6237\u7aefID\uff08\u5b9e\u9645\u9879\u76ee\u4e2d\u53ef\u4f7f\u7528\u7528\u6237ID\u6216UUID\uff09\n        String clientId = String.valueOf(System.currentTimeMillis());\n        emitters.put(clientId, emitter);\n\n        // \u53d1\u9001\u5fc3\u8df3\u5305\u4fdd\u6301\u8fde\u63a5\n        scheduler.scheduleAtFixedRate(() -> {\n            try {\n                emitter.send(SseEmitter.event()\n                    .id(String.valueOf(System.currentTimeMillis()))\n                    .name("heartbeat")\n                    .data("ping"));\n            } catch (IOException e) {\n                // \u53d1\u9001\u5931\u8d25\uff0c\u79fb\u9664\u5ba2\u6237\u7aef\n                emitter.completeWithError(e);\n                emitters.remove(clientId);\n            }\n        }, 0, 15, TimeUnit.SECONDS);\n\n        // \u8bbe\u7f6e\u56de\u8c03\n        emitter.onCompletion(() -> emitters.remove(clientId));\n        emitter.onTimeout(() -> emitters.remove(clientId));\n        emitter.onError(e -> emitters.remove(clientId));\n\n        return emitter;\n    }\n\n    // \u5411\u6240\u6709\u5ba2\u6237\u7aef\u63a8\u9001\u6d88\u606f\n    public void pushToAll(String event, String data) {\n        emitters.forEach((clientId, emitter) -> {\n            try {\n                emitter.send(SseEmitter.event()\n                    .id(String.valueOf(System.currentTimeMillis()))\n                    .name(event)\n                    .data(data));\n            } catch (IOException e) {\n                emitter.completeWithError(e);\n                emitters.remove(clientId);\n            }\n        });\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"3-\u914d\u7f6e\u5f02\u6b65\u652f\u6301",children:(0,i.jsx)(n.strong,{children:"3. \u914d\u7f6e\u5f02\u6b65\u652f\u6301"})}),"\n",(0,i.jsx)(n.p,{children:"\u786e\u4fddSpring MVC\u652f\u6301\u5f02\u6b65\u8bf7\u6c42\u5904\u7406\uff0c\u5728\u914d\u7f6e\u7c7b\u4e2d\u6dfb\u52a0\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"import org.springframework.context.annotation.Configuration;\nimport org.springframework.web.servlet.config.annotation.AsyncSupportConfigurer;\nimport org.springframework.web.servlet.config.annotation.WebMvcConfigurer;\n\n@Configuration\npublic class WebConfig implements WebMvcConfigurer {\n    @Override\n    public void configureAsyncSupport(AsyncSupportConfigurer configurer) {\n        // \u8bbe\u7f6e\u5f02\u6b65\u8bf7\u6c42\u8d85\u65f6\u65f6\u95f4\uff08\u53ef\u9009\uff09\n        configurer.setDefaultTimeout(30 * 60 * 1000L);\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"4-\u5ba2\u6237\u7aef\u4f7f\u7528\u793a\u4f8b",children:(0,i.jsx)(n.strong,{children:"4. \u5ba2\u6237\u7aef\u4f7f\u7528\u793a\u4f8b"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const eventSource = new EventSource('/sse');\n\n// \u76d1\u542c\u9ed8\u8ba4\u4e8b\u4ef6\neventSource.onmessage = (event) => {\n  console.log('Received:', event.data);\n};\n\n// \u76d1\u542c\u81ea\u5b9a\u4e49\u4e8b\u4ef6\uff08\u5982heartbeat\uff09\neventSource.addEventListener('heartbeat', (event) => {\n  console.log('Heartbeat:', event.data);\n});\n\n// \u9519\u8bef\u5904\u7406\neventSource.onerror = (error) => {\n  console.error('EventSource failed:', error);\n  // \u53ef\u6dfb\u52a0\u91cd\u8fde\u903b\u8f91\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"5-\u4e3b\u52a8\u63a8\u9001\u6d88\u606f\u793a\u4f8b",children:(0,i.jsx)(n.strong,{children:"5. \u4e3b\u52a8\u63a8\u9001\u6d88\u606f\u793a\u4f8b"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5728Service\u4e2d\u6ce8\u5165",(0,i.jsx)(n.code,{children:"SseController"}),"\u5e76\u8c03\u7528\u63a8\u9001\u65b9\u6cd5\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Service\npublic class NotificationService {\n    @Autowired\n    private SseController sseController;\n\n    public void sendNotification(String message) {\n        sseController.pushToAll("notification", message);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"6-\u5173\u952e\u914d\u7f6e\u8bf4\u660e",children:(0,i.jsx)(n.strong,{children:"6. \u5173\u952e\u914d\u7f6e\u8bf4\u660e"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5fc3\u8df3\u673a\u5236"}),"\uff1a\u901a\u8fc7\u5b9a\u65f6\u53d1\u9001",(0,i.jsx)(n.code,{children:"heartbeat"}),"\u4e8b\u4ef6\u4fdd\u6301\u8fde\u63a5\u6d3b\u8dc3"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5f02\u5e38\u5904\u7406"}),"\uff1a\u5728",(0,i.jsx)(n.code,{children:"onError"}),"\u3001",(0,i.jsx)(n.code,{children:"onTimeout"}),"\u4e2d\u79fb\u9664\u5931\u6548\u7684",(0,i.jsx)(n.code,{children:"SseEmitter"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5e76\u53d1\u5b89\u5168"}),"\uff1a\u4f7f\u7528",(0,i.jsx)(n.code,{children:"ConcurrentHashMap"}),"\u5b58\u50a8\u5ba2\u6237\u7aef\u8fde\u63a5"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u8d85\u65f6\u8bbe\u7f6e"}),"\uff1a\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u8c03\u6574",(0,i.jsx)(n.code,{children:"SseEmitter"}),"\u7684\u8d85\u65f6\u65f6\u95f4"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"7-\u751f\u4ea7\u73af\u5883\u4f18\u5316\u5efa\u8bae",children:(0,i.jsx)(n.strong,{children:"7. \u751f\u4ea7\u73af\u5883\u4f18\u5316\u5efa\u8bae"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u8fde\u63a5\u7ba1\u7406"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4f7f\u7528\u7528\u6237ID\u5173\u8054",(0,i.jsx)(n.code,{children:"SseEmitter"}),"\uff0c\u5b9e\u73b0\u5b9a\u5411\u63a8\u9001"]}),"\n",(0,i.jsx)(n.li,{children:"\u6dfb\u52a0\u8fde\u63a5\u6570\u9650\u5236\uff0c\u9632\u6b62\u8d44\u6e90\u8017\u5c3d"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u9519\u8bef\u5904\u7406"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6dfb\u52a0\u91cd\u8bd5\u673a\u5236\uff08\u5ba2\u6237\u7aef\u81ea\u52a8\u91cd\u8fde\uff09"}),"\n",(0,i.jsx)(n.li,{children:"\u5b9e\u73b0\u4f18\u96c5\u964d\u7ea7\uff08\u5982\u63a8\u9001\u5931\u8d25\u65f6\u8f6c\u77ed\u4fe1\u901a\u77e5\uff09"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u6027\u80fd\u4f18\u5316"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4f7f\u7528",(0,i.jsx)(n.code,{children:"ThreadPoolTaskScheduler"}),"\u66ff\u4ee3",(0,i.jsx)(n.code,{children:"Executors"})]}),"\n",(0,i.jsx)(n.li,{children:"\u7ed3\u5408Redis\u5b9e\u73b0\u96c6\u7fa4\u73af\u5883\u4e0b\u7684\u6d88\u606f\u5e7f\u64ad"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u5b89\u5168\u52a0\u56fa"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6dfb\u52a0\u6743\u9650\u9a8c\u8bc1\uff08\u5982JWT\u8ba4\u8bc1\uff09"}),"\n",(0,i.jsx)(n.li,{children:"\u4f7f\u7528HTTPS\u534f\u8bae\uff08wss://\uff09"}),"\n",(0,i.jsx)(n.li,{children:"\u5b9e\u73b0\u8bf7\u6c42\u9891\u7387\u9650\u5236"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"8-\u5b8c\u6574\u793a\u4f8b\u4ee3\u7801",children:(0,i.jsx)(n.strong,{children:"8. \u5b8c\u6574\u793a\u4f8b\u4ee3\u7801"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// \u5b8c\u6574\u7684SSE\u63a7\u5236\u5668\u793a\u4f8b\n@RestController\n@RequestMapping("/api/sse")\npublic class SseController {\n\n    private final Map<String, SseEmitter> emitters = new ConcurrentHashMap<>();\n    private final Logger logger = LoggerFactory.getLogger(SseController.class);\n\n    @GetMapping(produces = MediaType.TEXT_EVENT_STREAM_VALUE)\n    public SseEmitter subscribe(@RequestHeader("Authorization") String token) {\n        // 1. \u8eab\u4efd\u9a8c\u8bc1\n        String userId = validateToken(token);\n        \n        // 2. \u521b\u5efaSseEmitter\uff0c\u8d85\u65f6\u65f6\u95f4\u8bbe\u4e3a30\u5206\u949f\n        SseEmitter emitter = new SseEmitter(30 * 60 * 1000L);\n        \n        // 3. \u5b58\u50a8emitter\u5e76\u8bbe\u7f6e\u56de\u8c03\n        emitters.put(userId, emitter);\n        \n        emitter.onCompletion(() -> {\n            logger.info("SSE connection completed for user: {}", userId);\n            emitters.remove(userId);\n        });\n        \n        emitter.onTimeout(() -> {\n            logger.info("SSE connection timed out for user: {}", userId);\n            emitter.complete();\n            emitters.remove(userId);\n        });\n        \n        emitter.onError(e -> {\n            logger.error("SSE error for user: {}", userId, e);\n            emitter.completeWithError(e);\n            emitters.remove(userId);\n        });\n        \n        // 4. \u53d1\u9001\u521d\u59cb\u8fde\u63a5\u786e\u8ba4\n        try {\n            emitter.send(SseEmitter.event()\n                .id("0")\n                .name("connected")\n                .data("Connection established"));\n        } catch (IOException e) {\n            logger.error("Failed to send initial event to user: {}", userId, e);\n            emitter.completeWithError(e);\n            emitters.remove(userId);\n        }\n        \n        return emitter;\n    }\n\n    // \u63a8\u9001\u6d88\u606f\u5230\u6307\u5b9a\u7528\u6237\n    public void pushToUser(String userId, String event, Object data) {\n        SseEmitter emitter = emitters.get(userId);\n        if (emitter != null) {\n            try {\n                emitter.send(SseEmitter.event()\n                    .id(UUID.randomUUID().toString())\n                    .name(event)\n                    .data(data, MediaType.APPLICATION_JSON));\n            } catch (IOException e) {\n                logger.error("Failed to send event to user: {}", userId, e);\n                emitter.completeWithError(e);\n                emitters.remove(userId);\n            }\n        }\n    }\n\n    // \u63a8\u9001\u6d88\u606f\u5230\u6240\u6709\u7528\u6237\n    public void pushToAll(String event, Object data) {\n        emitters.forEach((userId, emitter) -> {\n            try {\n                emitter.send(SseEmitter.event()\n                    .id(UUID.randomUUID().toString())\n                    .name(event)\n                    .data(data, MediaType.APPLICATION_JSON));\n            } catch (IOException e) {\n                logger.error("Failed to send event to user: {}", userId, e);\n                emitter.completeWithError(e);\n                emitters.remove(userId);\n            }\n        });\n    }\n    \n    private String validateToken(String token) {\n        // JWT\u9a8c\u8bc1\u903b\u8f91\uff0c\u8fd4\u56de\u7528\u6237ID\n        return "user123";\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"9-\u5ba2\u6237\u7aef\u9ad8\u7ea7\u7528\u6cd5",children:(0,i.jsx)(n.strong,{children:"9. \u5ba2\u6237\u7aef\u9ad8\u7ea7\u7528\u6cd5"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// \u5e26\u91cd\u8fde\u673a\u5236\u7684\u5ba2\u6237\u7aef\u5b9e\u73b0\nclass EventSourceClient {\n    constructor(url) {\n        this.url = url;\n        this.eventSource = null;\n        this.retryCount = 0;\n        this.maxRetries = 5;\n        this.retryDelay = 1000; // \u521d\u59cb\u91cd\u8bd5\u5ef6\u8fdf(ms)\n    }\n\n    connect() {\n        this.eventSource = new EventSource(this.url);\n\n        this.eventSource.onopen = () => {\n            console.log('Connected to SSE server');\n            this.retryCount = 0;\n        };\n\n        this.eventSource.onmessage = (event) => {\n            console.log('Received message:', event.data);\n            // \u5904\u7406\u6d88\u606f\u903b\u8f91\n        };\n\n        this.eventSource.onerror = (error) => {\n            console.error('SSE error:', error);\n            this.retryCount++;\n            \n            if (this.retryCount <= this.maxRetries) {\n                const delay = this.retryDelay * Math.pow(2, this.retryCount);\n                console.log(`Reconnecting in ${delay/1000} seconds...`);\n                \n                setTimeout(() => {\n                    this.eventSource.close();\n                    this.connect();\n                }, delay);\n            } else {\n                console.error('Max retries exceeded. Giving up.');\n                // \u53ef\u6dfb\u52a0\u989d\u5916\u5904\u7406\u903b\u8f91\uff0c\u5982\u901a\u77e5\u7528\u6237\n            }\n        };\n    }\n\n    disconnect() {\n        if (this.eventSource) {\n            this.eventSource.close();\n            this.eventSource = null;\n        }\n    }\n}\n\n// \u4f7f\u7528\u793a\u4f8b\nconst client = new EventSourceClient('/api/sse');\nclient.connect();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"10-\u5e38\u89c1\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848",children:(0,i.jsx)(n.strong,{children:"10. \u5e38\u89c1\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u8de8\u57df\u95ee\u9898"}),"\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Bean\npublic WebMvcConfigurer corsConfigurer() {\n    return new WebMvcConfigurer() {\n        @Override\n        public void addCorsMappings(CorsRegistry registry) {\n            registry.addMapping("/sse").allowedOrigins("http://your-client-domain.com");\n        }\n    };\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Nginx\u914d\u7f6e\u4f18\u5316"}),"\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-nginx",children:'location /sse {\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n    \n    proxy_http_version 1.1;\n    proxy_set_header Connection "";  # \u5173\u95edkeepalive\n    proxy_read_timeout 86400;        # \u5ef6\u957f\u8d85\u65f6\u65f6\u95f4\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u5927\u89c4\u6a21\u8fde\u63a5\u5904\u7406"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4f7f\u7528Reactor\u6a21\u5f0f\uff08\u5982Spring WebFlux\u7684",(0,i.jsx)(n.code,{children:"SseEmitter"}),"\u66ff\u4ee3\u65b9\u6848\uff09"]}),"\n",(0,i.jsx)(n.li,{children:"\u8003\u8651\u4f7f\u7528\u4e13\u95e8\u7684\u6d88\u606f\u4e2d\u95f4\u4ef6\uff08\u5982Redis Pub/Sub\u3001Kafka\uff09"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u901a\u8fc7\u4ee5\u4e0a\u65b9\u6848\uff0c\u4f60\u53ef\u4ee5\u5728Spring Boot 2\u4e2d\u9ad8\u6548\u5b9e\u73b0Server-Sent Events\u63a5\u53e3\uff0c\u6ee1\u8db3\u5b9e\u65f6\u6570\u636e\u63a8\u9001\u9700\u6c42\u3002"})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var t=r(6540);const i={},s=t.createContext(i);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);