(self.webpackChunkys_blog=self.webpackChunkys_blog||[]).push([[434],{124:(t,e,r)=>{var n=r(9325);t.exports=function(){return n.Date.now()}},346:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},659:(t,e,r)=>{var n=r(1873),i=Object.prototype,o=i.hasOwnProperty,u=i.toString,c=n?n.toStringTag:void 0;t.exports=function(t){var e=o.call(t,c),r=t[c];try{t[c]=void 0;var n=!0}catch(a){}var i=u.call(t);return n&&(e?t[c]=r:delete t[c]),i}},1800:t=>{var e=/\s/;t.exports=function(t){for(var r=t.length;r--&&e.test(t.charAt(r)););return r}},1873:(t,e,r)=>{var n=r(9325).Symbol;t.exports=n},2552:(t,e,r)=>{var n=r(1873),i=r(659),o=r(9350),u=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":u&&u in Object(t)?i(t):o(t)}},3805:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},4128:(t,e,r)=>{var n=r(1800),i=/^\s+/;t.exports=function(t){return t?t.slice(0,n(t)+1).replace(i,""):t}},4394:(t,e,r)=>{var n=r(2552),i=r(346);t.exports=function(t){return"symbol"==typeof t||i(t)&&"[object Symbol]"==n(t)}},4741:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>m});var n=r(6540),i=r(1635),o=r(7350),u=r.n(o);const c=function(t){var e=(0,n.useRef)(t);return e.current=t,e};const a=function(t){var e=c(t);(0,n.useEffect)((function(){return function(){e.current()}}),[])};const s=function(t,e){var r,o=c(t),s=null!==(r=null==e?void 0:e.wait)&&void 0!==r?r:1e3,l=(0,n.useMemo)((function(){return u()((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.current.apply(o,(0,i.__spreadArray)([],(0,i.__read)(t),!1))}),s,e)}),[]);return a((function(){l.cancel()})),{run:l,cancel:l.cancel,flush:l.flush}};var l=r(4848);const f=n.forwardRef((({index:t,columnWidth:e,screenRange:r,children:i,rect:o,itemLoaded:u,itemUpdated:c},a)=>{let s=(0,n.useRef)(null);(0,n.useEffect)((()=>{u(t)}),[]),(0,n.useEffect)((()=>{}),[o]),(0,n.useEffect)((()=>{let e=null;if(s.current){let r=null;e=new ResizeObserver((e=>{for(let n of e)clearTimeout(r),r=setTimeout((()=>{c(t)}),16)})),e.observe(s.current)}return()=>{e&&e.disconnect(),e=null}}),[s.current]),(0,n.useImperativeHandle)(a,(()=>s.current));const f=o?.top||0,[d,h]=r;let p=!1;return(!o?.top||f+(o?.height||0)>=d&&f<=h)&&(p=!0),p?(0,l.jsx)("div",{ref:s,className:"waterfall-item","data-index":t,style:{position:"absolute",left:void 0!==o?.left?o?.left:"-100%",top:o?.top||0,width:e,background:"white",overflow:"hidden"},children:i}):null})),d=n.forwardRef(((t,e)=>{const{children:r,columns:i=2,gapX:o,gapY:u,initialNumToRender:c=50,pageSize:a=20,threshold:d=250,bufferHeight:h=500,throttleTime:p=300,autoObserve:m=!0,className:g,virtualEnable:v=!1,onScroll:y,...x}=t,w="number"==typeof o?o:0,b="number"==typeof u?u:0;let j=(0,n.useRef)({width:0,height:0,columnWidth:0}),[R,E]=(0,n.useState)(0);const T=(0,n.useRef)({}),S=(0,n.useRef)({currentIndex:0,endIndex:0,rects:[],columnsHeight:{0:new Array(i).fill(0)}}),O=(0,n.useRef)([]),N=(0,n.useRef)([]),[I,W]=(0,n.useState)([]),[A,C]=(0,n.useState)([0,0]),[k,H]=(0,n.useState)(0),P=()=>{const{currentIndex:t,columnsHeight:e}=S.current;if(void 0!==T.current[t]&&Array.isArray(e[t])){const r=[...e[t]];Array.isArray(r);let n=[...r];n.sort(((t,e)=>t-e));const o=r.findIndex((t=>t===n[0])),u=r[o],c=0===u?u:u+b;r[o]=c+(T.current[t].value||0);let a=(w+j.current.columnWidth)*o;o===i-1&&(a=j.current.width-j.current.columnWidth);const[s,l]=A;S.current.rects[t]={top:c,left:a,width:j.current.columnWidth,height:T.current[t].value},S.current.currentIndex=t+1,S.current.columnsHeight[t+1]=[...r],W(JSON.parse(JSON.stringify(S.current.rects))),console.warn("\u8ba1\u7b97\u7ed3\u675f\u7b2c",t,"\u4e2a\u5143\u7d20\u8ba1\u7b97\u4f4d\u7f6e",S.current.currentIndex,S.current.rects[t],n,o),P()}},{run:J}=s((()=>{N.current.length>0&&(N.current.sort(((t,e)=>t-e)),S.current.currentIndex=N.current[0],S.current.endIndex=N.current[N.current.length-1],N.current=[],P())}),{wait:p}),{run:U}=s((t=>{const e=t.nativeEvent.target.scrollTop-h,i=t.nativeEvent.target.scrollTop+j.current.height+h;if(C([e,i]),n.Children.count(r)>c+k*a&&S.current.rects[c+k*a-1]){const{top:t=0,height:e=0}=S.current.rects[c+k*a-1];t+e<i+d&&(console.log("setPage + 1",k+1),H(k+1))}}),{wait:500}),$=t=>{if(O.current[t]&&void 0===T.current[t]){const e=O.current[t].getBoundingClientRect(),r=e.width?e.height/e.width*j.current.columnWidth:0;T.current[t]={value:r,history:[r]},P()}},_=t=>{if(void 0!==t&&O.current[t]){const e=O.current[t].getBoundingClientRect();Array.isArray(T.current[t]?.history)&&T.current[t].history[T.current[t].history.length-1]!==e.height&&(console.log("itemUpdated runRefreshRects",t,T.current[t].history,e),T.current[t].value=e.height,T.current[t].history.push(e.height),N.current.push(t),J())}else console.warn("\u7b2c",t,"\u5143\u7d20\u672a\u83b7\u53d6\u5230")};(0,n.useImperativeHandle)(e,(()=>({itemUpdated:_})),[]);const z=n.Children.map(r,((t,e)=>e<c+a*k?(0,l.jsx)(f,{ref:t=>O.current[e]=t,index:e,screenRange:A,rect:I[e],columnWidth:R,itemLoaded:$,itemUpdated:_,children:t},e):null));return[...S.current.columnsHeight[n.Children.count(r)-1]||[]].sort(((t,e)=>t-e)),(0,l.jsx)("div",{ref:t=>(t=>{if(t){const e=t.getBoundingClientRect();j.current.height!==e.height&&(j.current.height=e.height,j.current.width=e.width,j.current.columnWidth=Number(((j.current.width-(i-1)*w)/i).toFixed(0)),C([0,j.current.height]),E(j.current.columnWidth))}})(t),className:`waterfall ${g||""}`,onScroll:t=>{"function"==typeof y&&y(t),U(t)},...x,children:z})}));let h=["https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png","https://img0.baidu.com/it/u=3739429570,2783758709&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=750","https://gw.alipayobjects.com/zos/antfincdn/LlvErxo8H9/photo-1503185912284-5271ff81b9a8.webp","https://img0.baidu.com/it/u=8013311,3592244460&fm=253&fmt=auto&app=120&f=JPEG?w=500&h=617","https://img2.baidu.com/it/u=3018303209,1765139986&fm=253&fmt=auto&app=120&f=JPEG?w=500&h=722","https://img2.baidu.com/it/u=1533484450,2625314894&fm=253&fmt=auto&app=138&f=JPEG?w=664&h=500"];new Array(10).fill(1).forEach((()=>h=h.concat(h)));const p=({index:t,item:e})=>(0,l.jsxs)("div",{style:{width:"100%",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,l.jsx)("div",{children:t+1}),(0,l.jsx)("img",{width:"100%",height:"auto",src:e})]}),m=()=>{const[t,e]=(0,n.useState)([]);return(0,n.useEffect)((()=>{setTimeout((()=>{e(h),console.warn("data1",h)}),0)}),[]),(0,l.jsx)(d,{style:{background:"white"},className:"my-waterfall",initialNumToRender:50,pageSize:20,columns:5,gapX:20,gapY:20,autoObserve:!0,children:t.map(((t,e)=>(0,l.jsx)(p,{item:`${t}?time=${new Date}`,index:e})))})}},4840:(t,e,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;t.exports=n},7350:(t,e,r)=>{var n=r(8221),i=r(3805);t.exports=function(t,e,r){var o=!0,u=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return i(r)&&(o="leading"in r?!!r.leading:o,u="trailing"in r?!!r.trailing:u),n(t,e,{leading:o,maxWait:e,trailing:u})}},8221:(t,e,r)=>{var n=r(3805),i=r(124),o=r(9374),u=Math.max,c=Math.min;t.exports=function(t,e,r){var a,s,l,f,d,h,p=0,m=!1,g=!1,v=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function y(e){var r=a,n=s;return a=s=void 0,p=e,f=t.apply(n,r)}function x(t){var r=t-h;return void 0===h||r>=e||r<0||g&&t-p>=l}function w(){var t=i();if(x(t))return b(t);d=setTimeout(w,function(t){var r=e-(t-h);return g?c(r,l-(t-p)):r}(t))}function b(t){return d=void 0,v&&a?y(t):(a=s=void 0,f)}function j(){var t=i(),r=x(t);if(a=arguments,s=this,h=t,r){if(void 0===d)return function(t){return p=t,d=setTimeout(w,e),m?y(t):f}(h);if(g)return clearTimeout(d),d=setTimeout(w,e),y(h)}return void 0===d&&(d=setTimeout(w,e)),f}return e=o(e)||0,n(r)&&(m=!!r.leading,l=(g="maxWait"in r)?u(o(r.maxWait)||0,e):l,v="trailing"in r?!!r.trailing:v),j.cancel=function(){void 0!==d&&clearTimeout(d),p=0,a=h=s=d=void 0},j.flush=function(){return void 0===d?f:b(i())},j}},9325:(t,e,r)=>{var n=r(4840),i="object"==typeof self&&self&&self.Object===Object&&self,o=n||i||Function("return this")();t.exports=o},9350:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},9374:(t,e,r)=>{var n=r(4128),i=r(3805),o=r(4394),u=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,a=/^0o[0-7]+$/i,s=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(o(t))return NaN;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=n(t);var r=c.test(t);return r||a.test(t)?s(t.slice(2),r?2:8):u.test(t)?NaN:+t}}}]);